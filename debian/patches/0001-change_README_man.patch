From 995b68e74852511692e0292de4c350d57be63a48 Mon Sep 17 00:00:00 2001
From: zhaojiale <zhaojiale@loongson.cn>
Date: Thu, 17 Sep 2020 19:55:46 +0800
Subject: [PATCH] add xorg-dev libtool and libsysfs-dev dependency on UOS of
 README, and fill in manpage content.

Change-Id: I84804c0a8d13732bb77a54e35f79b2e314dd6772
---
 README           |  2 +-
 man/loongson.man | 53 +++++++++++++++++++++++++++++++++++------------------
 2 files changed, 36 insertions(+), 19 deletions(-)

diff --git a/README b/README
index 1531c18..6e211e3 100644
--- a/README
+++ b/README
@@ -34,7 +34,7 @@ git automake xorg-x11-util-macros libXrandr-devel libdrm-devel xorg-x11-server-d
 
 # On UOS, apt-get install
 
-automake xserver-xorg-dev libdrm-dev libudev-dev libgbm-dev  xutils-dev
+automake xserver-xorg-dev libdrm-dev libudev-dev libgbm-dev  xutils-dev xorg-dev libtool libsysfs-dev
 
 ### Build and Install
 
diff --git a/man/loongson.man b/man/loongson.man
index 34baa9c..b12c3d2 100644
--- a/man/loongson.man
+++ b/man/loongson.man
@@ -1,54 +1,71 @@
 .\" shorthand for double quote that works everywhere.
 .ds q \N'34'
-.TH MODESETTING __drivermansuffix__ __vendorversion__
+.TH Xserver-xorg-video-loongson __drivermansuffix__ __vendorversion__
 .SH NAME
-modesetting \- video driver for framebuffer device
+loongson \- loongson GPU video driver
 .SH SYNOPSIS
 .nf
 .B "Section \*qDevice\*q"
 .BI "  Identifier \*q"  devname \*q
-.B  "  Driver \*qmodesetting\*q"
-.BI "  BusID  \*qpci:" bus : dev : func \*q
+.B  "  Driver \*qloongson\*q"
 \ \ ...
 .B EndSection
 .fi
 .SH DESCRIPTION
-.B modesetting
-is an __xservername__ driver for KMS devices.  This is a non-accelerated
-driver, the following framebuffer depths are supported: 8, 15, 16, 24.
-All visual types are supported for depth 8, and TrueColor visual is
-supported for the other depths.  RandR 1.2 is supported.
+.B loongson
+is an __xservername__ driver for which kernel driver is loongson-drm. Acceleration is available through exa for devices. if exa is not enabled, using shadowfb. This driver supports TrueColor visuals at framebuffer depths of 15, 16, 24, and 30.
+ 
 .SH SUPPORTED HARDWARE
 The 
-.B modesetting
-driver supports all hardware where a KMS driver is available.
-modesetting uses the Linux DRM KMS ioctls and dumb object create/map.
+.B loongson
+driver supports hardware where a kernel driver must be loongson-drm.
 .SH CONFIGURATION DETAILS
 Please refer to __xconfigfile__(__filemansuffix__) for general configuration
-details.  This section only covers configuration details specific to
+details. This section only covers configuration details specific to
 this driver.
 .PP
 For this driver it is not required to specify modes in the screen 
-section of the config file.  The
-.B modesetting
+section of the config file. The
+.B loongson
 driver can pick up the currently used video mode from the kernel
 driver and will use it if there are no video modes configured.
 .PP
 For PCI boards you might have to add a BusID line to the Device
-section.  See above for a sample line.
+section. See above for a sample line.
 .PP
 The following driver 
 .B Options
 are supported:
 .TP
 .BI "Option \*qkmsdev\*q \*q" string \*q
-The framebuffer device to use. Default: /dev/dri/card0.
+The framebuffer device to use.  Default: /dev/dri/card0.
 .TP
 .BI "Option \*qShadowFB\*q \*q" boolean \*q
 Enable or disable use of the shadow framebuffer layer.  Default: on.
 .TP
+.BI "Option \*qPrimaryGPU\*q \*q" boolean \*q
+This option specifies that the matched device should be treated as the primary GPU, replacing the selection of the GPU used as output by the firmware. If multiple output devices match an OutputClass section with the PrimaryGPU option set, the first one enumerated becomes the primary GPU.  Default: on
+.TP
+.BI "Option \*qAccelMethod\*q \*q" string \*q
+Accelerate method to use. First try glamor(but this version is not accomplished, we are now developing), then try EXA. if both failed, using the shadowfb.
+.TP
+.BI "Option \*qSWcursor\*q \*q" boolean \*q
+Enable or disable use of the software cursor.  Default: on
+.TP
+.BI "Option \*qExaType\*q \*q" string \*q
+Acceleration method of the EXA: "fake", "software", "vivante", "etnaviv". The "vivante", "software" and "etnaviv" is not yet implemented.  Default: fake
+.TP
+.BI "Option \*qAtomic\*q \*q" boolean \*q
+Enable or disable use of the Atomic it can guarantee the consistency of the data read under multithreading.  Default: on
+.TP
+.BI "Option \*qDoubleShadow\*q \*q" boolean \*q
+Enable or disable use of the Double-buffer Shadow. Double-buffer shadow updates. When enabled, the driver will keep two copies of the shadow framebuffer. When the shadow framebuffer is flushed, the old and new versions of the shadow are compared, and only tiles that have actually changed are uploaded to the device. This is an optimization for server-class GPUs with a remote display function (typically VNC), where remote updates are triggered by any framebuffer write, so minimizing the amount of data uploaded is crucial. This defaults to enabled for ASPEED and Matrox G200 devices, and disabled otherwise.  Default: on
+.TP
+.BI "Option \*qPageFlip\*q \*q" boolean \*q
+Enable DRI3 page flipping.  Default: on
+.TP
 .SH "SEE ALSO"
 __xservername__(__appmansuffix__), __xconfigfile__(__filemansuffix__), Xserver(__appmansuffix__),
 X(__miscmansuffix__)
 .SH AUTHORS
-Authors include: Dave Airlie
+Authors include: suijingfeng <suijingfeng@loongson.cn> zhaojiale <zhaojiale@loongson.cn>
-- 
2.1.0

